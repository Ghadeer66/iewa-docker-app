import{_ as ie}from"./AppLayout-cOSO_2th.js";import{r as k,b as R,e as u,o as n,a as e,f as S,t as x,n as A,F as M,h as P,g as ue,y as ce,C as de,H as ge,D as fe,E as te,s as me,w as se,T as be,I as ve,c as X,i as H,u as ae}from"./app-Cz0OShX1.js";import{_ as ye}from"./RulesButton-CDkc7klA.js";import{u as pe}from"./Footer-BkxFcN6N.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const xe={class:"meal-card bg-white rounded-2xl shadow-md hover:shadow-lg transition overflow-hidden border border-gray-200 flex flex-col relative"},he={class:"relative w-full bg-gray-100"},we=["src","alt"],ke={key:0,class:"absolute top-3 left-3 bg-green-600 text-white text-xs font-semibold px-3 py-1 rounded-full shadow"},_e={class:"p-4 flex flex-col flex-grow"},De={class:"flex justify-between items-center gap-4 bg-orange-100 p-3 rounded-xl mb-3"},$e={class:"font-bold text-gray-800 text-md"},je={class:"font-bold text-orange-500 text-md"},Ce={class:"flex justify-center items-center gap-2 mb-3"},Se={class:"font-semibold text-green-600 text-base"},Te={class:"flex justify-center mb-3"},Ie={class:"flex items-center justify-center gap-4 p-1 border border-gray-200 rounded-2xl w-40"},Me=["disabled"],Pe={class:"text-lg font-semibold"},Le={class:"flex-1 overflow-y-auto p-6 space-y-4"},Oe={class:"flex justify-between items-center border-b border-gray-200 pb-2 mb-4"},Ae={class:"text-xl font-semibold text-gray-800"},Je={key:0,class:"relative w-full"},Ee=["src","alt"],Fe={class:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-2"},Ne=["onClick"],Be=["src","alt"],We={class:"bg-gray-50 p-4 rounded-lg border border-gray-200"},ze={class:"space-y-1 text-gray-600 text-sm"},Re={class:"flex items-center justify-center gap-4 p-3 border border-gray-200 rounded-lg"},qe=["disabled"],Qe={class:"text-lg font-semibold"},Ve=["disabled"],Ye={class:"bg-gray-50 p-4 rounded-lg border border-gray-200"},He={class:"list-disc list-inside text-gray-600 text-sm"},Ue={class:"bg-gray-50 p-4 rounded-lg border border-gray-200"},Ge={class:"list-disc list-inside text-gray-600 text-sm"},Xe={class:"bg-gray-50 p-4 rounded-lg border border-gray-200"},Ke={class:"list-disc list-inside text-gray-600 text-sm"},Ze={class:"bg-gray-50 p-4 rounded-lg border border-gray-200"},et={class:"list-disc list-inside text-gray-600 text-sm"},tt={class:"w-80 border-l border-gray-200 bg-gray-50 p-4 flex flex-col"},at={class:"flex-1 space-y-3 overflow-y-auto"},lt={class:"flex-shrink-0"},st={class:"w-10 h-10 rounded-full bg-lime-400 flex items-center justify-center text-white text-lg font-bold"},rt={class:"flex flex-col"},nt={class:"font-semibold text-gray-800"},ot={class:"text-gray-600 text-sm"},it={__name:"MealCard",props:{meal:Object,isAuthenticated:{type:Boolean,default:!1}},emits:["open-calendar"],setup(l,{emit:W}){const w=l,J=k(!1),$=k(1),L={Ø±ÙˆØ²Ø§Ù†Ù‡:0,Ù‡ÙØªÚ¯ÛŒ:.2,Ù…Ø§Ù‡Ø§Ù†Ù‡:.4},z=R(()=>{const d=w.meal.price||0;return Math.round(d*(1-L.Ø±ÙˆØ²Ø§Ù†Ù‡)*$.value)}),T=R(()=>{const d=w.meal.price||0;return Object.entries(L).map(([o,r])=>({plan:o,discountPercent:r*100,priceAfterDiscount:Math.round(d*(1-r)*$.value)}))}),h=()=>{J.value=!0},j=()=>{J.value=!1},I=()=>{$.value++},O=()=>{$.value>1&&$.value--},q=W,E=()=>{const d=w.meal.thumbnail_url??w.meal.image_url??(w.meal.image?`/${w.meal.image}`:"/images/placeholder.png");q("open-calendar",{basePrice:z.value,mealId:w.meal.id,mealTitle:w.meal.title,mealImage:d,quantity:$.value})},f=k([{user:"Ù†ÛŒÙ„ÙˆÙØ± Ø²Ù…Ø§Ù†ÛŒ",text:"Ú©ÛŒÙÛŒØª ÙÙˆÙ‚ Ø§Ù„Ø¹Ø§Ø¯Ù‡ Ú©Ø§Ù…Ù„Ø§ ØªØ§Ø²Ù‡"},{user:"Ù†ÛŒÙ„ÙˆÙØ± Ø´Ú©Ø±Ø§Ù†Ù‡ Ø§Ù‚Ø¯Ø§Ù…",text:"ÙˆØ§Ù„Ø§ Ø®ÙˆØ´Ù…Ø²Ù‡ Ùˆ Ø¹Ø§Ù„ÛŒ Ø¨ÙˆØ¯ Ø¢Ø¯Ù… Ø§Ø²Ø´ Ø³ÛŒØ± Ù†Ù…ÛŒØ´Ù‡"},{user:"Ø´ÛŒÙ…Ø§ Ø·ÙˆØ³ÛŒ",text:"ÙˆØ§Ù‚Ø¹Ø§ Ø¹Ø§Ù„ÛŒ Ùˆ Ø¨ÛŒÙ†Ø¸ÛŒØ± Ø¨ÙˆØ¯"},{user:"Ø¢ÛŒØ¯Ø§ Ø·Ø§Ù„Ø¨ÛŒ",text:"Ø³Ø§Ù„Ø§Ø¯ Ù‡Ø§ Ù‡Ù…ÛŒØ´Ù‡ Ø®ÛŒÙ„ÛŒ ØªØ§Ø²Ù‡ Ùˆ ÙØ±Ø´ Ù‡Ø³Øª Ù„Ø·ÙØ§ Ù‡Ù…ÛŒÙ† Ø¬ÙˆØ±ÛŒ Ø¨Ù…ÙˆÙ†ÛŒØ¯"},{user:"Ù†ÛŒÙ„ÙˆÙØ± Ø­Ø¯Ø§Ø¯ÛŒØ§Ù†",text:"Ø¯Ø®ØªØ±Ù… Ø§Ø² Ù…Ø´ØªØ±ÛŒ Ù‡Ø§ÛŒ Ø´Ù…Ø§Ø³Øª Ùˆ ÙˆØ§Ù‚Ø¹Ø§ Ø§Ø² Ø®ÙˆØ±Ø¯Ù† ØºØ°Ø§Ù‡Ø§ÛŒ Ø´Ù…Ø§ Ù„Ø°Øª Ù…ÛŒØ¨Ø±Ù‡"},{user:"Ù…Ø±ØªØ¶ÛŒ Ù¾ÛŒØ±ÙˆØ§Ù†ÛŒ",text:"ØªÙ†ÙˆØ¹ ØºØ°Ø§Ù‡Ø§ Ø®ÙˆØ¨Ù‡ Ø§ÛŒÙ† Ø³Ø§Ù„Ø§Ø¯ Ùˆ Ù…Ù† Ø§Ø² Ø¨ÙˆØªÛŒÚ© Ú¯Ø±ÙØªÙ‡ Ø¨ÙˆØ¯Ù…"}]),y=R(()=>{const d=Array.isArray(w.meal?.images)?w.meal.images.map(o=>{const r=o?.url;return r?r.startsWith("http://")||r.startsWith("https://")||r.startsWith("/")?r:`/${r}`:null}).filter(Boolean):[];return d.length===0&&w.meal?.image_url?[w.meal.image_url]:d}),t=k(0),s=()=>{y.value.length>0&&(t.value=(t.value+1)%y.value.length)},m=()=>{y.value.length>0&&(t.value=(t.value-1+y.value.length)%y.value.length)},v=d=>{d>=0&&d<y.value.length&&(t.value=d)};return(d,o)=>(n(),u("div",xe,[e("div",he,[e("img",{src:l.meal.thumbnail_url??l.meal.image_url??(l.meal.image?`/${l.meal.image}`:"/images/placeholder.png"),alt:l.meal.title||"meal",class:"w-full object-cover rounded-t-2xl",style:{"aspect-ratio":"3 / 2"}},null,8,we),l.meal.is_new?(n(),u("span",ke," Ø¬Ø¯ÛŒØ¯ ")):S("",!0)]),e("div",_e,[e("div",De,[e("h3",$e,x(l.meal.title),1),e("h3",je,x(l.meal.kcal)+" Ú©Ø§Ù„Ø±ÛŒ ",1)]),e("div",Ce,[o[1]||(o[1]=e("span",{class:"text-sm text-gray-500"},"Ù‚ÛŒÙ…Øª:",-1)),e("span",Se,x(z.value.toLocaleString())+" ØªÙˆÙ…Ø§Ù†",1)]),e("div",Te,[e("div",Ie,[e("button",{onClick:O,disabled:$.value<=1,class:A([$.value>1?"bg-gray-200 text-gray-600 hover:bg-gray-300":"bg-gray-100 text-gray-400 cursor-not-allowed","w-8 h-8 rounded-full transition flex items-center justify-center"])},"-",10,Me),e("span",Pe,x($.value),1),e("button",{onClick:I,class:"w-8 h-8 rounded-full bg-gray-200 text-gray-600 hover:bg-gray-300 transition flex items-center justify-center"},"+")])]),e("div",{class:"flex justify-center gap-3"},[e("button",{onClick:h,class:"bg-yellow-100 text-yellow-700 border border-yellow-300 px-4 py-1 rounded-md text-sm hover:bg-yellow-200 transition cursor-pointer"}," Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ± "),e("button",{onClick:E,class:"px-4 py-2 rounded-md text-sm transition bg-green-500 text-white hover:bg-green-600"}," Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ² ")])]),J.value?(n(),u("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",onClick:j},[e("div",{onClick:o[0]||(o[0]=ue(()=>{},["stop"])),class:"bg-white rounded-xl shadow-xl w-full max-w-5xl max-h-[85vh] overflow-hidden border border-gray-200 flex"},[e("div",Le,[e("div",Oe,[e("button",{onClick:j,class:"text-gray-500 hover:text-gray-700 text-2xl font-bold cursor-pointer"}," Ã— "),e("h2",Ae,x(l.meal.title),1)]),y.value.length>1?(n(),u("div",Je,[e("img",{src:y.value[t.value],alt:l.meal.title||"meal",class:"w-full object-cover rounded-lg shadow-sm",style:{"aspect-ratio":"3 / 2"}},null,8,Ee),e("button",{onClick:m,class:"absolute left-2 top-1/2 -translate-y-1/2 bg-black/40 text-white w-8 h-8 rounded-full flex items-center justify-center"},"â€¹"),e("button",{onClick:s,class:"absolute right-2 top-1/2 -translate-y-1/2 bg-black/40 text-white w-8 h-8 rounded-full flex items-center justify-center"},"â€º"),e("div",Fe,[(n(!0),u(M,null,P(y.value,(r,b)=>(n(),u("button",{key:b,onClick:F=>v(b),class:A([b===t.value?"bg-white":"bg-white/50","w-2.5 h-2.5 rounded-full"])},null,10,Ne))),128))])])):(n(),u("img",{key:1,src:y.value[0]??l.meal.image_url??(l.meal.image?`/${l.meal.image}`:"/images/placeholder.png"),alt:l.meal.title||"meal",class:"w-full object-cover rounded-lg shadow-sm",style:{"aspect-ratio":"3 / 2"}},null,8,Be)),e("div",We,[o[2]||(o[2]=e("h3",{class:"font-semibold text-gray-700 mb-2"},"Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªØºØ°ÛŒÙ‡â€ŒØ§ÛŒ",-1)),e("div",ze,[(n(!0),u(M,null,P(l.meal.nutritional_informations,(r,b)=>(n(),u("div",{key:b,class:"flex justify-between"},[e("span",null,x(b),1),e("span",null,x(r),1)]))),128))])]),e("div",Re,[e("button",{onClick:O,disabled:$.value<=1,class:A([$.value>1?"bg-gray-200 text-gray-600 hover:bg-gray-300":"bg-gray-100 text-gray-400 cursor-not-allowed","w-8 h-8 rounded-full transition flex items-center justify-center"])},"-",10,qe),e("span",Qe,x($.value),1),e("button",{onClick:I,class:"w-8 h-8 rounded-full bg-gray-200 text-gray-600 hover:bg-gray-300 transition flex items-center justify-center"},"+")]),e("button",{onClick:E,disabled:l.isAuthenticated,class:"w-full bg-green-500 text-white py-3 rounded-md text-sm font-medium hover:bg-green-600 transition disabled:bg-gray-300 disabled:cursor-not-allowed"}," Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ² ",8,Ve),e("div",Ye,[o[3]||(o[3]=e("h3",{class:"font-semibold text-gray-700 mb-2"},"Ù…ÙˆØ§Ø±Ø¯ Ù…Ù†Ø¹ Ù…ØµØ±Ù",-1)),e("ul",He,[(n(!0),u(M,null,P(l.meal.contraindications,r=>(n(),u("li",{key:r},x(r),1))),128))])]),e("div",Ue,[o[4]||(o[4]=e("h3",{class:"font-semibold text-gray-700 mb-2"},"Ù…ÙˆØ§Ø±Ø¯ Ù…ØµØ±Ù",-1)),e("ul",Ge,[(n(!0),u(M,null,P(l.meal.consumable_items,r=>(n(),u("li",{key:r},x(r),1))),128))])]),e("div",Xe,[o[5]||(o[5]=e("h3",{class:"font-semibold text-gray-700 mb-2"},"Ù…Ø­ØªÙˆÛŒØ§Øª",-1)),e("ul",Ke,[(n(!0),u(M,null,P(l.meal.ingredients,r=>(n(),u("li",{key:r.id},x(r.title),1))),128))])]),e("div",Ze,[o[6]||(o[6]=e("h3",{class:"font-semibold text-gray-700 mb-2"},"ðŸ’¡ ØªØ®ÙÛŒÙ Ù¾Ù„Ù†â€ŒÙ‡Ø§",-1)),e("ul",et,[(n(!0),u(M,null,P(T.value,r=>(n(),u("li",{key:r.plan},x(r.plan)+": "+x(r.discountPercent)+"Ùª Ù‚ÛŒÙ…Øª Ù¾Ø³ Ø§Ø² ØªØ®ÙÛŒÙ: "+x(r.priceAfterDiscount.toLocaleString())+" ØªÙˆÙ…Ø§Ù† ",1))),128))])])]),e("div",tt,[o[7]||(o[7]=e("h3",{class:"font-semibold text-gray-800 mb-3"},"Ù†Ø¸Ø±Ø§Øª Ø´Ù…Ø§",-1)),o[8]||(o[8]=e("div",{class:"flex mb-4 gap-2"},[e("input",{type:"text",placeholder:"ØªÙˆ Ù‡Ù… Ù†Ø¸Ø± Ø®ÙˆØ¯Øª Ø±Ùˆ Ø¨Ø²Ø§Ø±...",class:"flex-grow p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),e("button",{class:"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition"},"Ø§Ø±Ø³Ø§Ù„ Ù†Ø¸Ø±")],-1)),e("div",at,[(n(!0),u(M,null,P(f.value,(r,b)=>(n(),u("div",{key:b,class:"flex gap-3 bg-white p-3 rounded-lg border border-gray-200"},[e("div",lt,[e("div",st,x(r.user.charAt(0)),1)]),e("div",rt,[e("span",nt,x(r.user),1),e("span",ot,x(r.text),1)])]))),128))])])])])):S("",!0)]))}};var Z,le;function ut(){if(le)return Z;le=1,Z={toJalaali:W,toGregorian:w,isValidJalaaliDate:J,isLeapJalaaliYear:$,jalaaliMonthLength:L,jalCal:T,j2d:h,d2j:j,g2d:I,d2g:O,jalaaliToDateObject:E,jalaaliWeek:q};var l=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];function W(t,s,m){return Object.prototype.toString.call(t)==="[object Date]"&&(m=t.getDate(),s=t.getMonth()+1,t=t.getFullYear()),j(I(t,s,m))}function w(t,s,m){return O(h(t,s,m))}function J(t,s,m){return t>=-61&&t<=3177&&s>=1&&s<=12&&m>=1&&m<=L(t,s)}function $(t){return z(t)===0}function L(t,s){return s<=6?31:s<=11||$(t)?30:29}function z(t){var s=l.length,m=l[0],v,d,o,r,b;if(t<m||t>=l[s-1])throw new Error("Invalid Jalaali year "+t);for(b=1;b<s&&(v=l[b],d=v-m,!(t<v));b+=1)m=v;return r=t-m,d-r<6&&(r=r-d+f(d+4,33)*33),o=y(y(r+1,33)-1,4),o===-1&&(o=4),o}function T(t,s){var m=l.length,v=t+621,d=-14,o=l[0],r,b,F,Q,i,c,p;if(t<o||t>=l[m-1])throw new Error("Invalid Jalaali year "+t);for(p=1;p<m&&(r=l[p],b=r-o,!(t<r));p+=1)d=d+f(b,33)*8+f(y(b,33),4),o=r;return c=t-o,d=d+f(c,33)*8+f(y(c,33)+3,4),y(b,33)===4&&b-c===4&&(d+=1),Q=f(v,4)-f((f(v,100)+1)*3,4)-150,i=20+d-Q,s?{gy:v,march:i}:(b-c<6&&(c=c-b+f(b+4,33)*33),F=y(y(c+1,33)-1,4),F===-1&&(F=4),{leap:F,gy:v,march:i})}function h(t,s,m){var v=T(t,!0);return I(v.gy,3,v.march)+(s-1)*31-f(s,7)*(s-7)+m-1}function j(t){var s=O(t).gy,m=s-621,v=T(m,!1),d=I(s,3,v.march),o,r,b;if(b=t-d,b>=0){if(b<=185)return r=1+f(b,31),o=y(b,31)+1,{jy:m,jm:r,jd:o};b-=186}else m-=1,b+=179,v.leap===1&&(b+=1);return r=7+f(b,30),o=y(b,30)+1,{jy:m,jm:r,jd:o}}function I(t,s,m){var v=f((t+f(s-8,6)+100100)*1461,4)+f(153*y(s+9,12)+2,5)+m-34840408;return v=v-f(f(t+100100+f(s-8,6),100)*3,4)+752,v}function O(t){var s,m,v,d,o;return s=4*t+139361631,s=s+f(f(4*t+183187720,146097)*3,4)*4-3908,m=f(y(s,1461),4)*5+308,v=f(y(m,153),5)+1,d=y(f(m,153),12)+1,o=f(s,1461)-100100+f(8-d,6),{gy:o,gm:d,gd:v}}function q(t,s,m){var v=E(t,s,m).getDay(),d=v==6?0:-(v+1),o=6+d;return{saturday:j(h(t,s,m+d)),friday:j(h(t,s,m+o))}}function E(t,s,m,v,d,o,r){var b=w(t,s,m);return new Date(b.gy,b.gm-1,b.gd,v||0,d||0,o||0,r||0)}function f(t,s){return~~(t/s)}function y(t,s){return t-~~(t/s)*s}return Z}var ct=ut();const dt={dir:"rtl",class:"relative"},gt={key:0,class:"fixed top-70 left-1/2 transform -translate-x-1/2 bg-orange-500 text-white px-6 py-4 rounded shadow-lg z-50"},ft={key:0,class:"fixed inset-0 flex items-center justify-center backdrop-blur-md bg-white/30 z-50"},mt={class:"bg-white rounded-2xl shadow-2xl max-w-4xl w-11/12 p-6 relative overflow-y-auto max-h-[85vh] flex gap-6"},bt={class:"flex-1"},vt={class:"max-w-lg mx-auto mb-4"},yt={class:"grid grid-cols-7 gap-1 text-xs font-bold text-gray-600 mb-2 text-center"},pt=["onClick"],xt={key:0,class:"absolute -top-3 -right-2 flex flex-col items-center"},ht={class:"text-[12px]"},wt={key:1,class:"absolute inset-0 flex items-center justify-end ml-1.5 text-sm font-bold text-gray-900"},kt={class:"absolute bottom-0 left-0 w-full bg-gray-200 text-[10px] font-bold text-gray-800 text-center rounded-b-sm flex items-center justify-center"},_t={key:0},Dt={key:1,class:"text-blue-500 text-[10px]"},$t={key:0,class:"text-center text-sm text-gray-600 mb-2"},jt={class:"w-75 flex flex-col py-16 items-stretch"},Ct={class:"flex flex-col gap-4 w-full"},St={class:"font-bold text-lg text-center mb-2"},Tt={class:"flex justify-between w-full px-2"},It={class:"ml-6"},Mt={class:"flex justify-between w-full px-2"},Pt={class:"ml-10"},Lt={class:"flex justify-between w-full px-2"},Ot={class:"ml-10"},At={class:"flex justify-between w-full px-2"},Jt={class:"ml-6"},Et={class:"flex justify-between w-full px-2 mt-5"},Ft={class:"ml-6"},Nt={__name:"Calender",props:{open:Boolean,basePrice:{type:Number,default:2e5},mealId:{type:String,default:"default"},mealTitle:{type:String,default:"Ù…Ø­ØµÙˆÙ„"},mealImage:{type:String,default:""},mealQuantity:{type:Number,default:1}},emits:["update:open","continue"],setup(l,{emit:W}){const w=l,J=W,$=R({get:()=>w.open,set:g=>J("update:open",g)}),L=k(!0),z=["Ø´","ÛŒ","Ø¯","Ø³","Ú†","Ù¾","Ø¬"],T=R(()=>{const a=(new Date().getDay()+1)%7,C=[];for(let _=0;_<7;_++)C.push(z[(a+_)%7]);return C}),h=k([]),j=k([]),I=k(!1),O=pe(),{items:q}=ce(O),E=R(()=>{const g=Object.create(null);for(const a of q.value)g[a.dateISO]=(g[a.dateISO]||0)+1;for(const a of h.value)g[a]=(g[a]||0)+1;return g}),f=k(0),y=k("daily"),t=k("---"),s=k(""),m=k(!1),v=R(()=>{const g=Math.round((f.value||0)*100);return(g>0?g:0).toLocaleString("fa-IR")+"Ùª"}),d=k(w.basePrice),o=k(0),r=k(0),b=g=>g.toLocaleString("fa-IR"),F=R(()=>{switch(y.value){case"daily":return"bg-red-600";case"weekly":return"bg-green-600";case"monthly":return"bg-purple-600";default:return"bg-gray-500"}});function Q(){const g=[],a=new Date;let _=new Date(a);for(;g.length<28;){const B=(_.getDay()+1)%7,V=ct.toJalaali(_.getFullYear(),_.getMonth()+1,_.getDate()),G=_.toDateString()===a.toDateString();g.push({gDate:new Date(_),fullDate:_.toISOString().split("T")[0],jDate:V.jd,jMonth:V.jm,jYear:V.jy,isToday:G,isSelected:!1,weekdaySatIndex:B}),_.setDate(_.getDate()+1)}const D=[];for(let B=0;B<28;B+=7)D.push(g.slice(B,B+7));j.value=D}function i(g){const a=g.weekdaySatIndex;return a===5||a===6}function c(g){const a=new Date,C=new Date;C.setDate(a.getDate()+1);const _=new Date;_.setDate(a.getDate()+2);const D=new Date(g.gDate);return D.toDateString()===a.toDateString()?"today":D.toDateString()===C.toDateString()?"tomorrow":D.toDateString()===_.toDateString()?"afterTomorrow":"other"}function p(g){const a=g.fullDate,C=c(g);if(C==="afterTomorrow"){const _=h.value.indexOf(a);_===-1?(h.value=h.value.filter(D=>{const B=j.value.flat().find(G=>G.fullDate===D);return c(B)!=="afterTomorrow"}),h.value.push(a),I.value=!0):(h.value.splice(_,1),I.value=!1)}else{if(C==="today"&&I.value)return;{const _=h.value.indexOf(a);_===-1?h.value.push(a):h.value.splice(_,1)}}j.value.forEach(_=>_.forEach(D=>D.isSelected=h.value.includes(D.fullDate))),N()}function N(){if(d.value=w.basePrice,o.value=0,r.value=0,s.value="",m.value=f.value>0,h.value.length===0){y.value="daily",t.value="Ù‡ÛŒÚ† Ø±ÙˆØ²ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡";return}const g=h.value.length,a=new Set;j.value.forEach((B,V)=>{B.filter(oe=>h.value.includes(oe.fullDate)).length>=1&&a.add(V)}),g>=8&&a.size===j.value.length?(y.value="monthly",t.value="Ø®Ø±ÛŒØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡",s.value="Û´Û°Ùª",m.value=!0):g>=3?(y.value="weekly",t.value="Ø®Ø±ÛŒØ¯ Ù‡ÙØªÚ¯ÛŒ",s.value="Û²Û°Ùª",m.value=!0):(y.value="daily",t.value="Ø®Ø±ÛŒØ¯ Ø±ÙˆØ²Ø§Ù†Ù‡",s.value="Ø¨Ø¯ÙˆÙ† ØªØ®ÙÛŒÙ",m.value=!1);let C=0;y.value==="weekly"&&(C=.2),y.value==="monthly"&&(C=.4);const D=w.basePrice*(1-(f.value||0))*(1-C);d.value=Math.round(D),o.value=d.value,r.value=d.value*g}function U(g){return(E.value[g]||0).toLocaleString("fa-IR")}function Y(g){const a=c(g);if(i(g))return"bg-gray-200 text-gray-400 border border-gray-300";if(I.value&&a==="today")return"bg-gray-200 text-gray-400 border border-gray-300 cursor-not-allowed";if(g.isSelected)switch(y.value){case"daily":return"bg-red-500 text-white border-2 border-red-700";case"weekly":return"bg-green-500 text-white border-2 border-green-700";case"monthly":return"bg-purple-500 text-white border-2 border-purple-700";default:return"bg-blue-200 text-black border-2 border-blue-400"}return g.isToday?"border-2 border-blue-500 bg-blue-50 text-gray-800":"bg-white text-gray-800 cursor-pointer border border-gray-300 hover:bg-blue-100"}const ee=()=>L.value=window.scrollY<50;de(async()=>{Q(),window.addEventListener("scroll",ee);try{const{data:g}=await ge.get("/api/me/subsidy"),a=Number(g?.percentage??0);!Number.isNaN(a)&&a>0?f.value=Math.min(Math.max(a,0),100)/100:f.value=0}catch{f.value=0}N()}),fe(()=>{window.removeEventListener("scroll",ee)});const K=k(!1);function ne(){h.value.length>0&&O.addSelections(w.mealId,w.mealTitle,h.value.slice(),d.value,w.mealImage,w.mealQuantity||1),h.value=[],j.value.forEach(g=>g.forEach(a=>a.isSelected=!1)),N(),K.value=!0,setTimeout(()=>K.value=!1,3e3),$.value=!1}return te(()=>w.mealId,()=>{h.value=[],j.value.forEach(g=>g.forEach(a=>a.isSelected=!1)),N()}),te(q,()=>{N()}),(g,a)=>(n(),u("div",dt,[e("button",{onClick:a[0]||(a[0]=C=>$.value=!0),class:A(["fixed top-3/5 transform -translate-y-1/2 transition-all duration-700 z-50 cursor-pointer shadow-lg flex items-center justify-center font-bold text-white left-0",L.value?"px-6 py-3 rounded-r-xl text-base bg-[#4e3356]":"px-4 py-2 rounded-r-xl text-sm opacity-70 bg-[#4e3356] hover:px-6 hover:py-3 hover:text-base hover:opacity-100"])},[e("span",null,x(L.value?"Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ² Ø¯Ø± ØªÙ‚ÙˆÛŒÙ…":"ØªÙ‚ÙˆÛŒÙ… Ù…Ù†"),1)],2),me(be,{name:"fade"},{default:se(()=>[K.value?(n(),u("div",gt," Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± ØªÙ‚ÙˆÛŒÙ… Ø±Ø²Ø±Ùˆ Ø´Ø¯ ")):S("",!0)]),_:1}),$.value?(n(),u("div",ft,[e("div",mt,[e("button",{onClick:ne,class:"absolute top-2 right-3 text-gray-600 hover:text-black text-xl cursor-pointer","aria-label":"Return"},a[2]||(a[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 inline",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("path",{d:"M12 8l4 4-4 4m4-4H8"})],-1)])),e("div",bt,[a[4]||(a[4]=e("h2",{class:"text-2xl font-bold mb-4 text-black text-center"},"Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ² Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Ø¯Ø± ØªÙ‚ÙˆÛŒÙ… Ú©Ø§Ø±ÛŒ",-1)),e("div",vt,[e("div",yt,[(n(!0),u(M,null,P(T.value,C=>(n(),u("div",{key:C},x(C),1))),128))]),(n(!0),u(M,null,P(j.value,(C,_)=>(n(),u("div",{key:_,class:"grid grid-cols-7 gap-2 mb-9"},[(n(!0),u(M,null,P(C,D=>(n(),u("div",{key:D.fullDate,onClick:()=>!i(D)&&p(D),class:A([Y(D),"w-14 h-14 rounded-sm relative transition-colors select-none cursor-pointer group"])},[i(D)?S("",!0):(n(),u("div",xt,[e("div",ht,x(U(D.fullDate)),1),a[3]||(a[3]=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6 text-black drop-shadow-sm"},[e("path",{"fill-rule":"evenodd",d:"M2.25 2.25a.75.75 0 000 1.5h1.636l1.808 8.138a2.25 2.25 0 002.202 1.762h9.743a2.25 2.25 0 002.15-1.61l1.605-5.743A.75.75 0 0021 5.25H6.832l-.3-1.35A2.25 2.25 0 004.5 2.25H2.25zm16.5 18a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm-9 0a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z","clip-rule":"evenodd"})],-1))])),i(D)?S("",!0):(n(),u("div",wt," 0 ")),e("div",kt,[D.isToday?(n(),u("span",Dt,"Ø§Ù…Ø±ÙˆØ²")):(n(),u("span",_t,x(D.jDate),1))])],10,pt))),128))]))),128))]),h.value.length>0?(n(),u("div",$t," Ø±ÙˆØ²Ù‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡: "+x(h.value.length)+" Ø±ÙˆØ² ",1)):S("",!0)]),e("div",jt,[e("div",{class:A(["h-[350px] rounded-xl p-4 text-white flex flex-col items-center justify-center text-center transition-all duration-500",F.value])},[e("div",Ct,[e("div",St,x(t.value),1),e("div",Tt,[a[5]||(a[5]=e("div",{class:"font-medium text-cener mr-4"},"Ù‚ÛŒÙ…Øª Ù…Ø­ØµÙˆÙ„:",-1)),e("div",It,x(b(w.basePrice))+" ØªÙˆÙ…Ø§Ù†",1)]),e("div",Mt,[a[6]||(a[6]=e("div",{class:"font-medium text-center mr-4"},"Ø³ÙˆØ¨Ø³ÛŒØ¯ Ø´Ø±Ú©Øª:",-1)),e("div",Pt,x(v.value),1)]),e("div",Lt,[a[7]||(a[7]=e("div",{class:"font-medium text-center mr-4"},"ØªØ®ÙÛŒÙ:",-1)),e("div",Ot,x(y.value==="daily"?"Û°Ùª":s.value),1)]),e("div",At,[a[8]||(a[8]=e("div",{class:"font-medium text-center mr-4"},"Ø¬Ù…Ø¹:",-1)),e("div",Jt,x(b(o.value))+" ØªÙˆÙ…Ø§Ù†",1)]),e("div",Et,[a[9]||(a[9]=e("div",{class:"font-medium text-right mr-4"},"Ù‚Ø§Ø¨Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª:",-1)),e("div",Ft,x(b(r.value))+" ØªÙˆÙ…Ø§Ù†",1)])])],2),e("button",{class:"mt-5 h-12 bg-gray-200 text-black rounded-lg font-bold hover:bg-orange-300 transition-colors cursor-pointer",onClick:a[1]||(a[1]=C=>g.$emit("continue"))}," Ø§Ø¯Ø§Ù…Ù‡ Ø®Ø±ÛŒØ¯ ")])])])):S("",!0)]))}},Bt=re(Nt,[["__scopeId","data-v-5af8a07a"]]),Wt={class:"container mx-auto px-6 mb-8"},zt=["onClick"],Rt=["src","alt"],qt={key:0,class:"text-center py-8"},Qt={key:1,class:"container mx-auto px-6"},Vt={key:0,class:"text-center py-12"},Yt={key:1,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8 mb-8"},Ht={key:2,class:"mt-10 flex justify-center items-center gap-2 flex-wrap mb-8"},Ut={key:2,class:"px-2 text-gray-500"},Gt=["onClick"],Xt={key:3,class:"px-2 text-gray-500"},Kt={__name:"Index",props:{meals:Object,pagination:Object,filters:Object},setup(l){const W=k(!1),w=k(0),J=k(""),$=k(""),L=k(""),z=k(1),T=k(!1),h=k("Ù‡Ù…Ù‡"),j=k(!1),I=k(0),O=k(0),E=ve().props.auth?.user||null,f=l,y=[{title:"Ù‡Ù…Ù‡",type:"category"},{title:"Ù„Ø§ÛŒÙ† ØºØ°Ø§ÛŒ Ø§Ù‚ØªØµØ§Ø¯ÛŒ",image:"/images/food-categories/eco.png",type:"category"},{title:"Ù¾Ú© Ù…ÛŒØ§Ù†ÙˆØ¹Ø¯Ù‡",image:"/images/food-types/package.png",type:"category"},{title:"Ø³Ø§Ù„Ø§Ø¯",image:"/images/food-types/salad.png",type:"category"},{title:"Ø³Ø§Ù†Ø¯ÙˆÛŒÚ†",image:"/images/food-types/sandwich.png",type:"category"},{title:"Ú©ÛŒÚ© Ùˆ Ù†Ø§Ù†",image:"/images/food-types/cake.png",type:"category"},{title:"Ø¯Ù…Ù†ÙˆØ´ Ùˆ Ù‚Ù‡ÙˆÙ‡",image:"/images/food-types/coffee.png",type:"category"},{title:"Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ",image:"/images/food-types/drinks.png",type:"category"},{title:"Ø§ÙˆØªÙ…ÛŒÙ„",image:"/images/food-types/ot-meal.png",type:"category"},{title:"ØµØ¨Ø­Ø§Ù†Ù‡",image:"/images/food-types/breakfast.png",type:"category"},{title:"Ø¯Ø³Ø±â€ŒÙ‡Ø§",image:"/images/food-types/dessert.png",type:"category"}],t=R(()=>{if(!f.pagination)return[];const i=f.pagination.last_page,c=f.pagination.current_page;let p=Math.max(c-1,1),N=Math.min(c+1,i);c<=3&&(N=Math.min(5,i)),c>=i-2&&(p=Math.max(i-4,1));const U=[];for(let Y=p;Y<=N;Y++)U.push(Y);return U}),s=i=>{T.value=!0,h.value=i.title;const c=new URLSearchParams;i.type==="category"&&i.title!=="Ù‡Ù…Ù‡"&&c.append("category",i.title),H.get(`/menu?${c.toString()}`,{},{preserveState:!0,replace:!0,onFinish:()=>T.value=!1})},m=()=>{T.value=!0,h.value="Ù‡Ù…Ù‡",H.get("/menu",{},{preserveState:!0,replace:!0,onFinish:()=>T.value=!1})},v=i=>{T.value=!0;const c=new URLSearchParams;f.filters?.category&&f.filters.category!=="Ù‡Ù…Ù‡"&&c.append("category",f.filters.category),f.filters?.type&&c.append("type",f.filters.type),c.append("page",i),H.get(`/menu?${c.toString()}`,{},{preserveState:!0,replace:!0,onFinish:()=>T.value=!1})},d=i=>H.post("/cart",{meal_id:i.id,quantity:1}),o=i=>H.get(`/meals/${i.id}`);function r(i){const c=i&&typeof i=="object"&&"basePrice"in i?Number(i.basePrice):Number(i);w.value=isNaN(c)?0:c,i&&typeof i=="object"&&("mealId"in i&&(J.value=String(i.mealId)),"mealTitle"in i&&($.value=i.mealTitle||""),"mealImage"in i&&(L.value=i.mealImage||""),"quantity"in i&&(z.value=Number(i.quantity)||1)),W.value=!0}const b=i=>{j.value=!0,I.value=i.pageX-i.currentTarget.offsetLeft,O.value=i.currentTarget.scrollLeft},F=()=>j.value=!1,Q=i=>{if(!j.value)return;i.preventDefault();const p=i.pageX-i.currentTarget.offsetLeft-I.value;i.currentTarget.scrollLeft=O.value-p};return(i,c)=>(n(),X(ie,null,{default:se(()=>[c[7]||(c[7]=e("h1",{class:"text-3xl font-bold text-center text-gray-800 my-10"},"Ù…Ø­ØµÙˆÙ„Ø§Øª Ø§ÛŒÙˆØ§",-1)),e("div",Wt,[e("div",{class:"overflow-x-auto py-2 no-scrollbar",ref:"scrollContainer",onMousedown:b,onMouseup:F,onMouseleave:F,onMousemove:Q},[e("div",{class:A(["flex gap-3 w-max cursor-grab",{"cursor-grabbing":j.value}])},[(n(),u(M,null,P(y,p=>e("button",{key:p.title,onClick:N=>s(p),class:A(["flex items-center gap-2 flex-shrink-0 px-4 py-2 rounded-full border text-sm transition",h.value===p.title?"bg-blue-500 text-white border-blue-500":"bg-white border-gray-300 text-gray-700 hover:bg-gray-100"])},[p.image?(n(),u("img",{key:0,class:"w-5 h-5 object-contain",src:p.image,alt:p.title},null,8,Rt)):S("",!0),e("span",null,x(p.title),1)],10,zt)),64))],2)],544)]),T.value?(n(),u("div",qt,c[5]||(c[5]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"},null,-1),e("p",{class:"mt-2 text-gray-600"},"Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...",-1)]))):(n(),u("div",Qt,[l.meals.data.length===0?(n(),u("div",Vt,[c[6]||(c[6]=e("p",{class:"text-gray-500 text-lg"},"Ù…Ø­ØµÙˆÙ„ÛŒ Ø¨Ø§ ÙÛŒÙ„ØªØ± Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ ÛŒØ§ÙØª Ù†Ø´Ø¯.",-1)),e("button",{onClick:m,class:"mt-4 px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition cursor-pointer"}," Ø­Ø°Ù ÙÛŒÙ„ØªØ±Ù‡Ø§ ")])):(n(),u("div",Yt,[(n(!0),u(M,null,P(l.meals.data,p=>(n(),X(it,{key:p.id,meal:p,onAddToCart:d,onOpenCalendar:r,onViewDetails:o},null,8,["meal"]))),128))])),l.meals.data.length>0&&l.pagination.last_page>1?(n(),u("div",Ht,[l.pagination.current_page>1?(n(),u("button",{key:0,onClick:c[0]||(c[0]=p=>v(l.pagination.current_page-1)),class:"px-4 py-2 rounded-lg border border-gray-300 bg-white hover:bg-gray-100 transition cursor-pointer"}," Ù‚Ø¨Ù„ÛŒ ")):S("",!0),l.pagination.current_page>3&&!t.value.includes(1)?(n(),u("button",{key:1,onClick:c[1]||(c[1]=p=>v(1)),class:A(["px-3 py-1 rounded-lg border border-gray-300 cursor-pointer",l.pagination.current_page===1?"bg-blue-500 text-white border-blue-500":"bg-white hover:bg-gray-100"])}," 1 ",2)):S("",!0),l.pagination.current_page>4?(n(),u("span",Ut,"...")):S("",!0),(n(!0),u(M,null,P(t.value,p=>(n(),u("button",{key:p,onClick:N=>v(p),class:A(["px-3 py-1 rounded-lg border border-gray-300 cursor-pointer",p===l.pagination.current_page?"bg-blue-500 text-white border-blue-500":"bg-white hover:bg-gray-100"])},x(p),11,Gt))),128)),l.pagination.current_page<l.pagination.last_page-3?(n(),u("span",Xt,"...")):S("",!0),l.pagination.current_page<l.pagination.last_page-2&&!t.value.includes(l.pagination.last_page)?(n(),u("button",{key:4,onClick:c[2]||(c[2]=p=>v(l.pagination.last_page)),class:A(["px-3 py-1 rounded-lg border border-gray-300 cursor-pointer",l.pagination.last_page===l.pagination.current_page?"bg-blue-500 text-white border-blue-500":"bg-white hover:bg-gray-100"])},x(l.pagination.last_page),3)):S("",!0),l.pagination.current_page<l.pagination.last_page?(n(),u("button",{key:5,onClick:c[3]||(c[3]=p=>v(l.pagination.current_page+1)),class:"px-4 py-2 rounded-lg border border-gray-300 bg-white hover:bg-gray-100 transition cursor-pointer"}," Ø¨Ø¹Ø¯ÛŒ ")):S("",!0)])):S("",!0)])),ae(E)?(n(),X(ye,{key:2})):S("",!0),ae(E)?(n(),X(Bt,{key:3,open:W.value,"onUpdate:open":c[4]||(c[4]=p=>W.value=p),basePrice:w.value,mealId:J.value,mealTitle:$.value,mealImage:L.value,mealQuantity:z.value},null,8,["open","basePrice","mealId","mealTitle","mealImage","mealQuantity"])):S("",!0)]),_:1,__:[7]}))}},sa=re(Kt,[["__scopeId","data-v-4c0e2518"]]);export{sa as default};
