import{N as s,J as a}from"./app-C-zV1K6N.js";const n=s("cart",{state:()=>({items:[],pending:[]}),getters:{count:t=>t.items.length},actions:{async loadCart(){try{const{data:t}=await a.get("/cart");this.items=Array.isArray(t)?t:[]}catch(t){console.error("Failed to load cart:",t)}},initialize(t){this.items=Array.isArray(t)?t:[],this.pending=[]},async addSelections(t,r,e=1){try{await a.post("/cart",{mealId:t,dates:r,quantity:e}),await this.loadCart()}catch(i){console.error("Failed to add to cart:",i)}},async removeOne(t){const r=JSON.parse(JSON.stringify(this.items)),e=this.items.findIndex(i=>i.id===t);if(e!==-1){this.items[e].quantity>1?this.items[e].quantity=this.items[e].quantity-1:this.items.splice(e,1),this.pending.includes(t)||this.pending.push(t);try{await a.delete(`/cart/${t}/one`),await this.loadCart()}catch(i){this.items=r,console.error("Failed to remove one:",i)}finally{this.pending=this.pending.filter(i=>i!==t)}}},async removeAll(t){try{await a.delete(`/cart/${t}/all`),await this.loadCart()}catch(r){console.error("Failed to remove all:",r)}},async clearAll(){try{await a.delete("/cart"),this.items=[]}catch(t){console.error("Failed to clear cart:",t)}}}});export{n as useCartStore};
