import{f as r,o as a,d as e,t as l,s as k,l as N,k as C,r as n,m as S,a as A,w as O,F as V,j,i as $,g as h,e as w,p as T,v as M}from"./app-DKZoIzNk.js";const I={class:"min-h-screen bg-gray-100"},q={class:"bg-white shadow-sm border-b"},G={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},J={class:"flex justify-between items-center py-4"},K={class:"flex items-center space-x-4 space-x-reverse"},P={class:"text-gray-700 mx-4"},Q={__name:"BusinessAppLayout",setup(d){const u=()=>{C.post("/business/logout")};return(c,i)=>(a(),r("div",I,[e("header",q,[e("div",G,[e("div",J,[i[1]||(i[1]=e("div",{class:"flex items-center"},[e("h1",{class:"text-2xl font-bold text-blue-600"},"پنل شرکت")],-1)),e("div",K,[e("span",P,l(c.$page.props.auth.user.business_name),1),e("button",{onClick:u,class:"flex items-center gap-2 bg-red-500 hover:bg-red-600 text-white font-medium px-5 py-2 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-red-400"},[...i[0]||(i[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h4a2 2 0 012 2v1"})],-1),k(" خروج ",-1)])])])])])]),e("main",null,[N(c.$slots,"default")])]))}},R={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},W={class:"bg-white overflow-hidden shadow rounded-lg mb-8"},X={class:"px-4 py-5 sm:p-6"},Y={class:"text-lg font-semibold text-gray-900"},Z={class:"mt-2 text-sm text-gray-600"},ee={class:"mt-8"},se={class:"bg-white overflow-hidden shadow rounded-2xl border border-gray-100 mb-8"},te={class:"px-6 py-6"},le={key:0,class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden text-black"},oe={class:"divide-y divide-gray-200"},ae={class:"flex-1"},re={class:"text-sm font-semibold text-gray-800"},ne={class:"text-xs text-gray-500 mt-0.5"},de={class:"flex items-center gap-2"},ie=["onClick"],ue=["onClick"],ce={key:1,class:"text-sm text-gray-500 bg-gray-50 border border-dashed border-gray-300 rounded-xl p-4 text-center"},ve={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},xe={class:"bg-white overflow-hidden shadow rounded-2xl border border-gray-100"},me={class:"px-6 py-6"},pe={class:"block"},ge={class:"relative border-2 border-dashed rounded-xl p-6 text-center hover:bg-gray-50 transition"},be={class:"text-gray-600"},he={key:0,class:"mt-2 text-xs text-gray-500 truncate"},ye={class:"flex items-center gap-3"},fe=["disabled"],_e={class:"min-h-5"},we={key:0,class:"text-sm text-green-600"},ke={key:1,class:"text-sm text-red-600"},Ce={class:"bg-white overflow-hidden shadow rounded-2xl border border-gray-100"},Se={class:"px-6 py-6"},Ve={class:"border rounded-lg p-3 mb-4 bg-gray-50"},je={class:"flex justify-between items-center mb-2"},$e={class:"max-h-40 overflow-y-auto pr-2"},Me=["value"],Be={class:"text-sm text-gray-700"},Fe={key:1,class:"text-sm text-gray-500 text-center py-2"},Ee={class:"md:col-span-2 flex items-center gap-3 mt-2"},He=["disabled"],ze={class:"min-h-5"},De={key:0,class:"text-sm text-green-600"},Ue={key:1,class:"text-sm text-red-600"},Ne={__name:"Index",props:{user:Object,stats:Object},setup(d){const u=n(null),c=n(!1),i=n(""),p=n(""),B=t=>{u.value=t.target.files?.[0]||null},F=async()=>{if(i.value="",p.value="",!u.value){p.value="لطفاً فایل CSV را انتخاب کنید";return}const t=new FormData;t.append("file",u.value),c.value=!0;try{await C.post("/business/employees/upload",t,{forceFormData:!0,onSuccess:s=>{i.value=s?.props?.flash?.message||"آپلود انجام شد",u.value=null},onError:s=>{p.value=s?.file?.[0]||s?.message||"خطا در آپلود"},onFinish:()=>{c.value=!1}})}catch{p.value="خطای غیرمنتظره در آپلود",c.value=!1}},v=S({max_price:null,starts_at:""}),g=n(!1),y=n(""),m=n(""),x=n([]),b=n(!1),E=()=>{b.value?x.value=[]:x.value=d.user.clients.map(t=>t.id),b.value=!b.value},H=async()=>{if(y.value="",m.value="",x.value.length===0){m.value="هیچ کاربری انتخاب نشده است";return}if(!v.max_price){m.value="مقدار سوبسید الزامی است";return}g.value=!0;try{await C.post("/business/employees/subsidy-multiple",{client_ids:x.value,max_price:v.max_price,starts_at:v.starts_at||null},{onSuccess:t=>{y.value=t?.props?.flash?.message||"سوبسید برای کاربران انتخابی ذخیره شد",x.value=[],b.value=!1},onError:t=>{m.value=t?.message||"خطا در ذخیره سوبسید"},onFinish:()=>{g.value=!1}})}catch{m.value="خطای غیرمنتظره",g.value=!1}},z=n(null),D=n(null),f=S({id:null,name:"",personal_code:"",phone:""}),U=t=>{z.value=t.id,f.id=t.id,f.name=t.name||"",f.personal_code=t.personal_code||"",f.phone=t.phone||""},L=t=>{D.value=t};return(t,s)=>(a(),A(Q,null,{default:O(()=>[e("div",R,[e("div",W,[e("div",X,[e("h2",Y,"خوش آمدید، "+l(d.user.name),1),e("p",Z,"شما به عنوان نماینده "+l(d.user.business_name)+" وارد شده‌اید.",1)])]),e("div",ee,[e("div",se,[e("div",te,[s[5]||(s[5]=e("div",{class:"flex items-center justify-between mb-4"},[e("div",{class:"flex items-center gap-3"},[e("div",{class:"h-10 w-10 flex items-center justify-center rounded-xl bg-gray-50 text-gray-700"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M13 7a3 3 0 11-6 0 3 3 0 016 0zM2 15a6 6 0 1112 0H2z"})])]),e("div",null,[e("h3",{class:"text-base font-semibold text-gray-900"},"کاربران اختصاصی شما"),e("p",{class:"text-xs text-gray-500"},"لیست کاربران (مشتریان) مرتبط با شرکت شما")])])],-1)),e("div",null,[d.user.clients&&d.user.clients.length?(a(),r("div",le,[e("ul",oe,[(a(!0),r(V,null,j(d.user.clients,o=>(a(),r("li",{key:o.id,class:"flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors duration-150"},[e("div",ae,[e("div",re,l(o.name),1),e("div",ne,[s[3]||(s[3]=e("span",{class:"font-medium text-gray-600"},"کد پرسنلی:",-1)),k(" "+l(o.personal_code)+" ",1),s[4]||(s[4]=e("span",{class:"mx-2"},"•",-1)),k(" "+l(o.phone),1)])]),e("div",de,[e("button",{onClick:_=>U(o),class:"text-sm px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer"},"ویرایش",8,ie),e("button",{onClick:_=>L(o),class:"text-sm px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer"},"حذف",8,ue)])]))),128))])])):(a(),r("div",ce," هیچ کاربری به شما اختصاص داده نشده است. "))])])])]),e("div",ve,[e("div",xe,[e("div",me,[s[8]||(s[8]=e("div",{class:"flex items-center gap-3 mb-4"},[e("div",{class:"h-10 w-10 flex items-center justify-center rounded-xl bg-blue-50 text-blue-600"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M4 3a2 2 0 00-2 2v8a2 2 0 002 2h4l2 2 2-2h2a2 2 0 002-2V9l-5-6H4z"})])]),e("div",null,[e("h3",{class:"text-base font-semibold text-gray-900"},"آپلود کارکنان (CSV)"),e("p",{class:"text-xs text-gray-500"},"ستون‌های لازم: name, phone, personal code")])],-1)),e("form",{onSubmit:$(F,["prevent"]),class:"space-y-4"},[e("label",pe,[s[7]||(s[7]=e("span",{class:"block text-sm text-gray-700 mb-2"},"فایل CSV",-1)),e("div",ge,[e("input",{type:"file",accept:".csv,.txt",onChange:B,class:"absolute inset-0 opacity-0 cursor-pointer"},null,32),e("div",be,[s[6]||(s[6]=e("span",{class:"text-sm"},"فایل را اینجا رها کنید یا برای انتخاب کلیک کنید",-1)),u.value?(a(),r("div",he,l(u.value.name),1)):h("",!0)])])]),e("div",ye,[e("button",{disabled:c.value,type:"submit",class:"px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50 cursor-pointer"},l(c.value?"در حال آپلود...":"آپلود"),9,fe)]),e("div",_e,[i.value?(a(),r("span",we,l(i.value),1)):h("",!0),p.value?(a(),r("span",ke,l(p.value),1)):h("",!0)])],32)])]),e("div",Ce,[e("div",Se,[s[12]||(s[12]=e("div",{class:"flex items-center gap-3 mb-4"},[e("div",{class:"h-10 w-10 flex items-center justify-center rounded-xl bg-emerald-50 text-emerald-600"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11V5H9v2H7v2h2v2h2v-2h2V7h-2z"})])]),e("div",null,[e("h3",{class:"text-base font-semibold text-gray-900"},"تعریف سوبسید برای کاربران انتخابی"),e("p",{class:"text-xs text-gray-500"},"کاربران موردنظر را انتخاب کرده و مقدار سوبسید را تعیین کنید")])],-1)),e("div",Ve,[e("div",je,[s[9]||(s[9]=e("span",{class:"text-sm font-semibold text-gray-700"},"انتخاب کاربران",-1)),e("button",{onClick:E,type:"button",class:"text-xs text-emerald-600 hover:text-emerald-800"},l(b.value?"لغو انتخاب همه":"انتخاب همه"),1)]),e("div",$e,[d.user.clients&&d.user.clients.length?(a(!0),r(V,{key:0},j(d.user.clients,o=>(a(),r("div",{key:o.id,class:"flex items-center gap-2 py-1 border-b border-gray-100 last:border-none"},[w(e("input",{type:"checkbox",value:o.id,"onUpdate:modelValue":s[0]||(s[0]=_=>x.value=_),class:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"},null,8,Me),[[T,x.value]]),e("span",Be,l(o.name)+" — "+l(o.personal_code),1)]))),128)):(a(),r("div",Fe," هیچ کاربری وجود ندارد. "))])]),e("form",{onSubmit:$(H,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end text-black"},[e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm text-gray-700 mb-1"},"سوبسید روزانه (تومان)",-1)),w(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>v.max_price=o),type:"number",min:"0",max:"5000000",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"0"},null,512),[[M,v.max_price,void 0,{number:!0}]])]),e("div",null,[s[11]||(s[11]=e("label",{class:"block text-sm text-gray-700 mb-1"},"از تاریخ",-1)),w(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>v.starts_at=o),type:"date",class:"w-full border rounded-lg px-3 py-2"},null,512),[[M,v.starts_at]])]),e("div",Ee,[e("button",{disabled:g.value||x.value.length===0||!v.max_price,type:"submit",class:"px-4 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white disabled:opacity-50 cursor-pointer"},l(g.value?"در حال ذخیره...":"اعمال سوبسید"),9,He),e("div",ze,[y.value?(a(),r("span",De,l(y.value),1)):h("",!0),m.value?(a(),r("span",Ue,l(m.value),1)):h("",!0)])])],32)])])])])]),_:1}))}};export{Ne as default};
