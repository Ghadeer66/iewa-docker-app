import{e as v,o as u,a as e,t as a,h as V,g as h,r as i,i as S,c as $,w as B,b as f,j as x,d as g,v as _}from"./app-EXdxEWgl.js";const j={class:"min-h-screen bg-gray-100"},M={class:"bg-white shadow-sm border-b"},E={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},F={class:"flex justify-between items-center py-4"},U={class:"flex items-center space-x-4 space-x-reverse"},D={class:"text-gray-700 mx-4"},z={__name:"BusinessAppLayout",setup(y){const o=()=>{h.post("/business/logout")};return(n,r)=>(u(),v("div",j,[e("header",M,[e("div",E,[e("div",F,[r[0]||(r[0]=e("div",{class:"flex items-center"},[e("h1",{class:"text-2xl font-bold text-blue-600"},"پنل شرکت")],-1)),e("div",U,[e("span",D,a(n.$page.props.auth.user.business_name),1),e("button",{onClick:o,class:"text-red-600 hover:text-red-800"},"خروج")])])])]),e("main",null,[V(n.$slots,"default")])]))}},H={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},A={class:"bg-white overflow-hidden shadow rounded-lg mb-8"},L={class:"px-4 py-5 sm:p-6"},N={class:"text-lg font-semibold text-gray-900"},O={class:"mt-2 text-sm text-gray-600"},I={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},T={class:"bg-white overflow-hidden shadow rounded-2xl border border-gray-100"},X={class:"px-6 py-6"},q={class:"block"},G={class:"relative border-2 border-dashed rounded-xl p-6 text-center hover:bg-gray-50 transition"},J={class:"text-gray-600"},K={key:0,class:"mt-2 text-xs text-gray-500 truncate"},P={class:"flex items-center gap-3"},Q=["disabled"],R={class:"min-h-5"},W={key:0,class:"text-sm text-green-600"},Y={key:1,class:"text-sm text-red-600"},Z={class:"bg-white overflow-hidden shadow rounded-2xl border border-gray-100"},ee={class:"px-6 py-6"},se={class:"md:col-span-2 flex items-center gap-3 mt-2"},te=["disabled"],le={class:"min-h-5"},ae={key:0,class:"text-sm text-green-600"},oe={key:1,class:"text-sm text-red-600"},re={__name:"Index",props:{user:Object,stats:Object},setup(y){const o=i(null),n=i(!1),r=i(""),c=i(""),w=l=>{o.value=l.target.files?.[0]||null},k=async()=>{if(r.value="",c.value="",!o.value){c.value="لطفاً فایل CSV را انتخاب کنید";return}const l=new FormData;l.append("file",o.value),n.value=!0;try{await h.post("/business/employees/upload",l,{forceFormData:!0,onSuccess:s=>{r.value=s?.props?.flash?.message||"آپلود انجام شد",o.value=null},onError:s=>{c.value=s?.file?.[0]||s?.message||"خطا در آپلود"},onFinish:()=>{n.value=!1}})}catch{c.value="خطای غیرمنتظره در آپلود",n.value=!1}},t=S({personal_code:"",percentage:null,starts_at:"",ends_at:""}),m=i(!1),b=i(""),p=i(""),C=async()=>{if(b.value="",p.value="",!t.personal_code||!t.percentage){p.value="کد پرسنلی و درصد الزامی است";return}m.value=!0;try{await h.post("/business/employees/subsidy-by-code",{personal_code:t.personal_code,percentage:t.percentage,starts_at:t.starts_at||null,ends_at:t.ends_at||null},{onSuccess:l=>{b.value=l?.props?.flash?.message||"سوبسید ذخیره شد"},onError:l=>{p.value=l?.personal_code?.[0]||l?.percentage?.[0]||l?.message||"خطا در ذخیره"},onFinish:()=>{m.value=!1}})}catch{p.value="خطای غیرمنتظره",m.value=!1}};return(l,s)=>(u(),$(z,null,{default:B(()=>[e("div",H,[e("div",A,[e("div",L,[e("h2",N,"خوش آمدید، "+a(y.user.name),1),e("p",O,"شما به عنوان نماینده "+a(y.user.business_name)+" وارد شده‌اید.",1)])]),e("div",I,[e("div",T,[e("div",X,[s[6]||(s[6]=e("div",{class:"flex items-center gap-3 mb-4"},[e("div",{class:"h-10 w-10 flex items-center justify-center rounded-xl bg-blue-50 text-blue-600"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M4 3a2 2 0 00-2 2v8a2 2 0 002 2h4l2 2 2-2h2a2 2 0 002-2V9l-5-6H4z"})])]),e("div",null,[e("h3",{class:"text-base font-semibold text-gray-900"},"آپلود کارکنان (CSV)"),e("p",{class:"text-xs text-gray-500"},"ستون‌های لازم: name, phone, personal code")])],-1)),e("form",{onSubmit:f(k,["prevent"]),class:"space-y-4"},[e("label",q,[s[5]||(s[5]=e("span",{class:"block text-sm text-gray-700 mb-2"},"فایل CSV",-1)),e("div",G,[e("input",{type:"file",accept:".csv,.txt",onChange:w,class:"absolute inset-0 opacity-0 cursor-pointer"},null,32),e("div",J,[s[4]||(s[4]=e("span",{class:"text-sm"},"فایل را اینجا رها کنید یا برای انتخاب کلیک کنید",-1)),o.value?(u(),v("div",K,a(o.value.name),1)):x("",!0)])])]),e("div",P,[e("button",{disabled:n.value,type:"submit",class:"px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50"},a(n.value?"در حال آپلود...":"آپلود"),9,Q)]),e("div",R,[r.value?(u(),v("span",W,a(r.value),1)):x("",!0),c.value?(u(),v("span",Y,a(c.value),1)):x("",!0)])],32)])]),e("div",Z,[e("div",ee,[s[11]||(s[11]=e("div",{class:"flex items-center gap-3 mb-4"},[e("div",{class:"h-10 w-10 flex items-center justify-center rounded-xl bg-emerald-50 text-emerald-600"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11V5H9v2H7v2h2v2h2v-2h2V7h-2z"})])]),e("div",null,[e("h3",{class:"text-base font-semibold text-gray-900"},"تعریف سوبسید کارمند"),e("p",{class:"text-xs text-gray-500"},"کد پرسنلی را وارد کنید و درصد را تنظیم کنید")])],-1)),e("form",{onSubmit:f(C,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end text-black"},[e("div",null,[s[7]||(s[7]=e("label",{class:"block text-sm text-gray-700 mb-1"},"کد پرسنلی کاربر",-1)),g(e("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>t.personal_code=d),type:"text",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"مثلاً XA123"},null,512),[[_,t.personal_code]])]),e("div",null,[s[8]||(s[8]=e("label",{class:"block text-sm text-gray-700 mb-1"},"درصد",-1)),g(e("input",{"onUpdate:modelValue":s[1]||(s[1]=d=>t.percentage=d),type:"number",min:"1",max:"100",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"1-100"},null,512),[[_,t.percentage,void 0,{number:!0}]])]),e("div",null,[s[9]||(s[9]=e("label",{class:"block text-sm text-gray-700 mb-1"},"از تاریخ",-1)),g(e("input",{"onUpdate:modelValue":s[2]||(s[2]=d=>t.starts_at=d),type:"date",class:"w-full border rounded-lg px-3 py-2"},null,512),[[_,t.starts_at]])]),e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm text-gray-700 mb-1"},"تا تاریخ",-1)),g(e("input",{"onUpdate:modelValue":s[3]||(s[3]=d=>t.ends_at=d),type:"date",class:"w-full border rounded-lg px-3 py-2"},null,512),[[_,t.ends_at]])]),e("div",se,[e("button",{disabled:m.value,type:"submit",class:"px-4 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white disabled:opacity-50"},a(m.value?"در حال ذخیره...":"ذخیره سوبسید"),9,te),e("div",le,[b.value?(u(),v("span",ae,a(b.value),1)):x("",!0),p.value?(u(),v("span",oe,a(p.value),1)):x("",!0)])])],32)])])])])]),_:1}))}};export{re as default};
